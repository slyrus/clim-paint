
(in-package :clim-paint)

(defun insert-before (new-item before-item list)
  "If before-item is a member of list, inserts new-item in list
 immediately before new-item, otherwise new-item is prepended to the
 beginning of list. Returns the (destructively) modified list."
  (let ((tail (member before-item list)))
            (if tail
                (progn (rplacd tail (cons (car tail) (cdr tail)))
                       (rplaca tail new-item))
                (push new-item list)))
  list)

(defun insert-after (new-item after-item list)
  "If after-item is a member of list, inserts new-item in list
immediately after new-item, otherwise it appends new-item to the end
of list. Returns the (destructively) modified list."
  (let ((tail (member after-item list)))
    (if tail
        (rplacd tail (cons new-item (cdr tail)))
        (append list (list new-item))))
  list)

(defun find-pane (name pane)
  (labels ((find-pane-aux (pane)
             (cond ((equal (pane-name pane) name)
                    (return-from find-pane pane))
                   (pane
                    (mapc #'find-pane-aux (sheet-children pane))))))
    (find-pane-aux pane)))

